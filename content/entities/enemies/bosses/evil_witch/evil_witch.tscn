[gd_scene load_steps=17 format=3 uid="uid://dtjpanhxa4wvc"]

[ext_resource type="Script" path="res://content/entities/enemies/bosses/evil_witch/evil_witch.gd" id="1_hu0do"]
[ext_resource type="Script" path="res://components/fighting/health.gd" id="1_ks78y"]
[ext_resource type="Script" path="res://components/fighting/damage_receiver.gd" id="2_g2sqk"]
[ext_resource type="Shader" path="res://vfx/common_shaders/sine_movement.gdshader" id="2_rtqxk"]
[ext_resource type="Script" path="res://components/fighting/knockback/knockback.gd" id="3_47f2s"]
[ext_resource type="Texture2D" uid="uid://dwl0tigw35r0f" path="res://content/entities/enemies/bosses/evil_witch/evil_witch.png" id="3_marsn"]
[ext_resource type="Shader" path="res://content/entities/enemies/bosses/evil_witch/evil_witch.gdshader" id="3_ueagc"]
[ext_resource type="Script" path="res://utils/damage_flash_sprite.gd" id="4_7geal"]
[ext_resource type="Script" path="res://components/state_machine.gd" id="5_7kvhu"]
[ext_resource type="Script" path="res://components/state.gd" id="6_ov4kn"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_nty7r"]
shader = ExtResource("2_rtqxk")
shader_parameter/amp = 0.0
shader_parameter/speed = 2.0
shader_parameter/dir = Vector2(0, 1)

[sub_resource type="Animation" id="Animation_rfd4m"]
resource_name = "spawn"
length = 5.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SpawnSprite:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 5),
"transitions": PackedFloat32Array(-2, 1),
"update": 0,
"values": [Vector2(306, -229), Vector2(0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("SpawnSprite:material:shader_parameter/amp")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 5),
"transitions": PackedFloat32Array(5.27803, 1),
"update": 0,
"values": [12.0, 0.0]
}

[sub_resource type="Animation" id="Animation_kdlpk"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SpawnSprite:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("SpawnSprite:material:shader_parameter/amp")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ru377"]
_data = {
"RESET": SubResource("Animation_kdlpk"),
"spawn": SubResource("Animation_rfd4m")
}

[sub_resource type="CircleShape2D" id="CircleShape2D_17jof"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_xe6vr"]
shader = ExtResource("3_ueagc")
shader_parameter/flash = null
shader_parameter/flash_color = Color(1, 1, 1, 1)

[node name="EvilWitch" type="Node2D"]
script = ExtResource("1_hu0do")

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("start_state")]
script = ExtResource("5_7kvhu")
start_state = NodePath("Idle")

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("6_ov4kn")

[node name="Health" type="Node" parent="."]
script = ExtResource("1_ks78y")
max_health = 500

[node name="SpawnSprite" type="Sprite2D" parent="."]
material = SubResource("ShaderMaterial_nty7r")
texture = ExtResource("3_marsn")
offset = Vector2(0, -12)
hframes = 3
vframes = 2
frame = 4

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_ru377")
}
autoplay = "spawn"

[node name="CharacterBody2D" type="CharacterBody2D" parent="."]
collision_layer = 4
motion_mode = 1

[node name="DamageReceiver" type="Node" parent="CharacterBody2D" node_paths=PackedStringArray("health")]
script = ExtResource("2_g2sqk")
health = NodePath("../../Health")

[node name="Knockback" type="Node2D" parent="CharacterBody2D"]
script = ExtResource("3_47f2s")

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterBody2D"]
shape = SubResource("CircleShape2D_17jof")

[node name="Sprite2D" type="Sprite2D" parent="CharacterBody2D"]
material = SubResource("ShaderMaterial_xe6vr")
texture = ExtResource("3_marsn")
offset = Vector2(0, -12)
hframes = 3
vframes = 2
script = ExtResource("4_7geal")

[connection signal="animation_finished" from="AnimationPlayer" to="." method="_on_spawn_animation_finished"]
[connection signal="damage_taken" from="CharacterBody2D/DamageReceiver" to="CharacterBody2D/Knockback" method="_on_damage_receiver_damage_taken"]
[connection signal="took_damage" from="CharacterBody2D/DamageReceiver" to="CharacterBody2D/Sprite2D" method="flash"]
